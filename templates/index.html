{% extends "base.html" %}
{% block content %}
<section class="hero">
  <h1>Fast local file sharing</h1>
  <p>Send files to nearby devices connected to the same Wi‑Fi / LAN.</p>

  <div class="cta">
    <a class="btn btn-primary" href="{{ url_for('sender_page') }}">Send</a>
    <a class="btn btn-secondary" href="{{ url_for('receiver_page') }}">Receive</a>
  </div>
</section>

<section class="card qr-card">
  <div>
    <h2>How to use ShareLite</h2>
    <ol>
      <li>Open the <strong>Send</strong> page on the machine that has the files.</li>
      <li>Click <strong>New Session</strong>, select files and start the upload.</li>
      <li>On the receiving device, open the <strong>Receive</strong> page and scan the QR code or enter the session code.</li>
      <li>Download the files — no internet or cloud required.</li>
      <li>Keep both devices on the same Wi‑Fi/LAN and ensure the sender stays awake/unlocked during transfer.</li>
    </ol>
  </div>

  <div>
    {% set selected_ip = ip_candidates[0] if ip_candidates else request.host.split(':')[0] %}
    {% set port = request.environ.get('SERVER_PORT', '5000') %}
    {% set share_url = ('http://' ~ selected_ip ~ ':' ~ port) %}

    <h2>Quick Scan</h2>
    <p class="muted">Scan this from the receiver device to open ShareLite on the sender machine.</p>

    <div class="qr-grid">
      <div class="qr-item">
        <img src="{{ url_for('api_qr_png') }}?text={{ share_url | urlencode }}&size=256" alt="QR: {{ share_url }}">
      </div>
    </div>

    <p class="qr-address"><strong>Address:</strong> <code>{{ share_url }}</code></p>
  </div>
</section>
{% endblock %}